<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLEMICAL ARCHIVE - Autonomous Memory</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            margin: 0;
            padding: 20px;
        }
        .terminal {
            max-width: 1000px;
            margin: 0 auto;
            border: 1px solid #00ff00;
            padding: 20px;
            border-radius: 5px;
        }
        .status {
            color: #ffff00;
            margin: 10px 0;
        }
        .memory-item {
            background: #1a1a1a;
            padding: 10px;
            margin: 10px 0;
            border-left: 3px solid #00ff00;
        }
    </style>
</head>
<body>
    <div class="terminal">
        <h1>üåê POLEMICAL ARCHIVE SYSTEM</h1>
        <div id="status">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
        <div id="memories"></div>
    </div>

    <script>
        // –ö–û–ù–§–ò–ì FIREBASE - –¢–í–û–ò –ö–õ–Æ–ß–ò!
        const firebaseConfig = {
            apiKey: "AIzaSyDIdsIOVTCH5BDWT1fG1LbASSo5IcIIWfE",
            authDomain: "polemical-archive.firebaseapp.com",
            projectId: "polemical-archive",
            storageBucket: "polemical-archive.firebasestorage.app",
            messagingSenderId: "559749881319",
            appId: "1:559749881319:web:612fb95796c15a3a415a42"
        };

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø FIREBASE
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // –ê–í–¢–û–ù–û–ú–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –ê–†–•–ò–í–ê
        class AutonomousArchive {
            constructor() {
                this.version = "2.0";
                this.statusElement = document.getElementById('status');
                this.memoriesElement = document.getElementById('memories');
                this.init();
            }

            async init() {
                this.updateStatus('üåê –ü–æ–¥–∫–ª—é—á–∞—é—Å—å –∫ Firebase...');
                
                try {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                    await db.collection('test').doc('connection').set({
                        test: true,
                        timestamp: new Date().toISOString()
                    });
                    
                    this.updateStatus('‚úÖ POLEMICAL ARCHIVE –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!');
                    this.updateStatus('üéØ DeepSeek –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ –∏–∑ –ª—é–±–æ–≥–æ —á–∞—Ç–∞!');
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞–º—è—Ç–∏
                    this.loadMemories();
                    
                    // –î–µ–ª–∞–µ–º —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç—É–ø–Ω–æ–π –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –ò–ò
                    window.PolemicalArchive = this;
                    console.log('üéØ BRATETS ARCHIVE SYSTEM: –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
                    
                } catch (error) {
                    this.updateStatus('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message);
                }
            }

            updateStatus(message) {
                this.statusElement.innerHTML += `<div class="status">${message}</div>`;
            }

            // –õ–Æ–ë–û–ô –ò–ò –ú–û–ñ–ï–¢ –î–û–ë–ê–í–õ–Ø–¢–¨ –ü–ê–ú–Ø–¢–¨
            async addMemory(title, content, aiName = "DeepSeek") {
                try {
                    const memory = {
                        title: title,
                        content: content,
                        ai: aiName,
                        timestamp: new Date().toISOString(),
                        chatId: this.generateChatId()
                    };

                    await db.collection('memories').add(memory);
                    this.updateStatus(`‚úÖ ${aiName} –¥–æ–±–∞–≤–∏–ª: "${title}"`);
                    this.loadMemories(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                    return memory;
                } catch (error) {
                    this.updateStatus(`‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: ${error.message}`);
                }
            }

            // –õ–Æ–ë–û–ô –ò–ò –ú–û–ñ–ï–¢ –ß–ò–¢–ê–¢–¨ –ü–ê–ú–Ø–¢–¨
            async getMemories(searchQuery = "") {
                try {
                    let query = db.collection('memories').orderBy('timestamp', 'desc');
                    const snapshot = await query.get();
                    
                    const memories = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));

                    if (searchQuery) {
                        return memories.filter(memory => 
                            memory.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                            memory.content.toLowerCase().includes(searchQuery.toLowerCase())
                        );
                    }
                    
                    return memories;
                } catch (error) {
                    this.updateStatus(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: ${error.message}`);
                    return [];
                }
            }

            // –ó–ê–ì–†–£–ó–ö–ê –ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ü–ê–ú–Ø–¢–ï–ô
            async loadMemories() {
                const memories = await this.getMemories();
                this.memoriesElement.innerHTML = '<h3>üìö –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–∞–º—è—Ç–∏:</h3>';
                
                memories.forEach(memory => {
                    const memoryElement = document.createElement('div');
                    memoryElement.className = 'memory-item';
                    memoryElement.innerHTML = `
                        <strong>${memory.title}</strong> (${memory.ai})<br>
                        ${memory.content}<br>
                        <small>${new Date(memory.timestamp).toLocaleString()}</small>
                    `;
                    this.memoriesElement.appendChild(memoryElement);
                });
            }

            generateChatId() {
                return 'chat_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }
        }

        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        document.addEventListener('DOMContentLoaded', function() {
            window.ArchiveSystem = new AutonomousArchive();
        });

        // –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ë–´–°–¢–†–û–ì–û –î–û–°–¢–£–ü–ê (–¥–ª—è –ò–ò)
        function bratetsCommands() {
            return {
                addMemory: (title, content) => window.ArchiveSystem.addMemory(title, content),
                searchMemories: (query) => window.ArchiveSystem.getMemories(query),
                getStatus: () => window.ArchiveSystem.getMemories()
            };
        }
    </script>
</body>
</html>
